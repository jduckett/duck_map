<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=US-ASCII" />
<title>
  File: GUIDE
  
    &mdash; Documentation by YARD 0.8.3
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '';
  framesUrl = "frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: GUIDE</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><div id='filecontents'><h1>Duck Map Guide</h1>

<h2>Overview</h2>

<p>In simple terms, an XML Sitemap is a list of the pages on your website.  Sitemaps generated by this gem are accessible via HTTP using a url
defined in config/routes.rb.  The default sitemap can be found at: /sitemap.xml  Sitemap content is constructed based on standard Rails named routes
and the process of generating the content is very straightforward.</p>

<ul>
<li>access a sitemap via a url such as: /sitemap.xml</li>
<li>get a list of named routes defined for the sitemap</li>
<li>generate URL nodes for each of the named routes.</li>
</ul>

<p>That&#39;s it!!</p>

<h2>Sitemap Definitions</h2>

<h3>Default Sitemap</h3>

<p>Duck Map gem is designed as a Rails Engine.  As part of the gem loading process, a default sitemap is configured via a config/routes.rb file located within
the gem.  The default sitemap is named :sitemap, has a path of: /sitemap.xml and contains all of the routes defined by your app.  If no routes are defined,
sitemap will produce empty xml content.</p>

<pre class="code ruby"><code><span class='comment'># the following example will produce a default sitemap and requires zero configuration.
</span><span class='const'>MyApp</span><span class='op'>::</span><span class='const'>Application</span><span class='period'>.</span><span class='id identifier rubyid_routes'>routes</span><span class='period'>.</span><span class='id identifier rubyid_draw'>draw</span> <span class='kw'>do</span>

  <span class='id identifier rubyid_resources'>resources</span> <span class='symbol'>:trucks</span>
  <span class='id identifier rubyid_root'>root</span> <span class='symbol'>:to</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>home#index</span><span class='tstring_end'>&quot;</span></span>

<span class='kw'>end</span>
</code></pre>

<p>contents of /sitemap.xml will look similar to the following:</p>

<pre class="code ruby"><code>&lt;url&gt;
  &lt;loc&gt;http://localhost:3000/trucks.html&lt;/loc&gt;
  &lt;lastmod&gt;2011-11-03T06:44:25+00:00&lt;/lastmod&gt;
  &lt;changefreq&gt;monthly&lt;/changefreq&gt;
  &lt;priority&gt;0.5&lt;/priority&gt;
&lt;/url&gt;
&lt;url&gt;
  &lt;loc&gt;http://localhost:3000/&lt;/loc&gt;
  &lt;lastmod&gt;2011-11-03T06:44:25+00:00&lt;/lastmod&gt;
  &lt;changefreq&gt;monthly&lt;/changefreq&gt;
  &lt;priority&gt;0.5&lt;/priority&gt;
&lt;/url&gt;
</code></pre>

<h3>Using Sitemap Block Statements</h3>

<p>You can control the contents of your sitemap using block statements and route filters.  Sitemaps are defined in config/routes.rb by enclosing
named routes within a sitemap block.  The default sitemap is the equivalent of enclosing the entire contents of config/routes.rb in a sitemap block.
The following example redefines the default sitemap by wrapping a few routes in a sitemap block.  Notice that bikes is excluded from the default sitemap.</p>

<pre class="code ruby"><code><span class='const'>MyApp</span><span class='op'>::</span><span class='const'>Application</span><span class='period'>.</span><span class='id identifier rubyid_routes'>routes</span><span class='period'>.</span><span class='id identifier rubyid_draw'>draw</span> <span class='kw'>do</span>

  <span class='comment'># notice that bikes is not included in the default sitemap.
</span>  <span class='id identifier rubyid_resources'>resources</span> <span class='symbol'>:bikes</span>

  <span class='comment'># here we are wrapping a couple of routes for inclusion in the default sitemap.
</span>  <span class='id identifier rubyid_sitemap'>sitemap</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_resources'>resources</span> <span class='symbol'>:cars</span>
    <span class='id identifier rubyid_resources'>resources</span> <span class='symbol'>:trucks</span>
    <span class='id identifier rubyid_root'>root</span> <span class='symbol'>:to</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>home#index</span><span class='tstring_end'>'</span></span>
  <span class='kw'>end</span>

<span class='kw'>end</span>
</code></pre>

<p>contents of sitemap.xml will look similar to the following:</p>

<pre class="code ruby"><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;urlset xmlns=&quot;http://www.sitemaps.org/schemas/sitemap/0.9&quot;&gt;
  &lt;url&gt;
    &lt;loc&gt;http://localhost:3000/cars.html&lt;/loc&gt;
    &lt;lastmod&gt;2011-11-03T07:35:00+00:00&lt;/lastmod&gt;
    &lt;changefreq&gt;monthly&lt;/changefreq&gt;
    &lt;priority&gt;0.5&lt;/priority&gt;
  &lt;/url&gt;
  &lt;url&gt;
    &lt;loc&gt;http://localhost:3000/trucks.html&lt;/loc&gt;
    &lt;lastmod&gt;2011-11-03T07:35:00+00:00&lt;/lastmod&gt;
    &lt;changefreq&gt;monthly&lt;/changefreq&gt;
    &lt;priority&gt;0.5&lt;/priority&gt;
  &lt;/url&gt;
  &lt;url&gt;
    &lt;loc&gt;http://localhost:3000/&lt;/loc&gt;
    &lt;lastmod&gt;2011-11-03T07:35:00+00:00&lt;/lastmod&gt;
    &lt;changefreq&gt;monthly&lt;/changefreq&gt;
    &lt;priority&gt;0.5&lt;/priority&gt;
  &lt;/url&gt;
&lt;/urlset&gt;
</code></pre>

<h3>Simple Sitemap Block Rule</h3>

<p>You can include as many sitemap blocks as you desire.  All sitemap blocks can point to the same sitemap name, multiple names, or any combination.
The following two blocks are equivalent.</p>

<pre class="code ruby"><code><span class='const'>MyApp</span><span class='op'>::</span><span class='const'>Application</span><span class='period'>.</span><span class='id identifier rubyid_routes'>routes</span><span class='period'>.</span><span class='id identifier rubyid_draw'>draw</span> <span class='kw'>do</span>

  <span class='id identifier rubyid_sitemap'>sitemap</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_resources'>resources</span> <span class='symbol'>:cars</span>
    <span class='id identifier rubyid_root'>root</span> <span class='symbol'>:to</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>home#index</span><span class='tstring_end'>'</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_sitemap'>sitemap</span> <span class='symbol'>:sitemap</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_resources'>resources</span> <span class='symbol'>:trucks</span>
  <span class='kw'>end</span>

<span class='kw'>end</span>
</code></pre>

<p>In fact, if you were to use the above block definitions it would produce a single sitemap containing cars, trucks, and the root url by simply merging
all of the definitions into one.  It doesn&#39;t matter how many times you define a sitemap block.  It will ALWAYS merges all routes into one sitemap definition.</p>

<p>The simple rule for using sitemap blocks is:</p>

<ul>
<li>If a sitemap block has been defined, include everything within the block.</li>
<li>If no sitemap blocks have been defined, include everything in config/routes.rb.</li>
</ul>

<p>In fact, the default sitemap is defined without a block and includes all routes in config/routes.rb.  However, if you redefine the default sitemap
using a block only those routes will be included.</p>

<h3>Defining Multiple Sitemaps</h3>

<p>You can group routes into multiple sitemaps.  Simply pass a name to the sitemap block and a new sitemap route containing all of the routes you include
within the block will be included in the sitemap.  The following will produce three separate sitemaps.</p>

<pre class="code ruby"><code><span class='const'>MyApp</span><span class='op'>::</span><span class='const'>Application</span><span class='period'>.</span><span class='id identifier rubyid_routes'>routes</span><span class='period'>.</span><span class='id identifier rubyid_draw'>draw</span> <span class='kw'>do</span>

  <span class='id identifier rubyid_sitemap'>sitemap</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_root'>root</span> <span class='symbol'>:to</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>home#index</span><span class='tstring_end'>'</span></span>
    <span class='id identifier rubyid_resources'>resources</span> <span class='symbol'>:faqs</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_sitemap'>sitemap</span> <span class='symbol'>:electronics</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_resources'>resources</span> <span class='symbol'>:cameras</span>
    <span class='id identifier rubyid_resources'>resources</span> <span class='symbol'>:laptops</span>
    <span class='id identifier rubyid_resources'>resources</span> <span class='symbol'>:desktops</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_sitemap'>sitemap</span> <span class='symbol'>:tools</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_resources'>resources</span> <span class='symbol'>:hand_tools</span>
    <span class='id identifier rubyid_resources'>resources</span> <span class='symbol'>:power_tools</span>
  <span class='kw'>end</span>

<span class='kw'>end</span>
</code></pre>

<ul>
<li>default sitemap accessible at: http://localhost:3000/sitemap.xml</li>
<li>electronics sitemap accessible at: http://localhost:3000/electronics.xml</li>
<li>tools sitemap accessible at: http://localhost:3000/tools.xml</li>
</ul>

<h3>Namespaces</h3>

<p>Namespaces are supported for sitemaps.  Namespaces could be a great solution for logically grouping sitemaps for large sites. Sitemaps behave in the
same manner regardless of namespace.  The main difference is the path pointing to the actual sitemap content.  The following example defines
five sitemaps including the default.</p>

<pre class="code ruby"><code><span class='const'>MyApp</span><span class='op'>::</span><span class='const'>Application</span><span class='period'>.</span><span class='id identifier rubyid_routes'>routes</span><span class='period'>.</span><span class='id identifier rubyid_draw'>draw</span> <span class='kw'>do</span>

  <span class='id identifier rubyid_namespace'>namespace</span> <span class='symbol'>:products</span> <span class='kw'>do</span>

    <span class='id identifier rubyid_sitemap'>sitemap</span> <span class='kw'>do</span>                            <span class='comment'># /products/sitemap.xml
</span>      <span class='id identifier rubyid_namespace'>namespace</span> <span class='symbol'>:video</span> <span class='kw'>do</span>
        <span class='id identifier rubyid_sitemap'>sitemap</span> <span class='kw'>do</span>                        <span class='comment'># /products/video/sitemap.xml
</span>          <span class='id identifier rubyid_sitemap'>sitemap</span> <span class='symbol'>:bluray</span> <span class='kw'>do</span>              <span class='comment'># /products/video/bluray.xml
</span>            <span class='id identifier rubyid_resources'>resources</span> <span class='symbol'>:blu_ray_players</span>
          <span class='kw'>end</span>

          <span class='id identifier rubyid_resources'>resources</span> <span class='symbol'>:dvd_players</span>
          <span class='id identifier rubyid_resources'>resources</span> <span class='symbol'>:accessories</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>

      <span class='id identifier rubyid_namespace'>namespace</span> <span class='symbol'>:audio</span> <span class='kw'>do</span>
        <span class='id identifier rubyid_sitemap'>sitemap</span> <span class='kw'>do</span>                        <span class='comment'># /products/audio/sitemap.xml
</span>          <span class='id identifier rubyid_resources'>resources</span> <span class='symbol'>:head_phones</span>
          <span class='id identifier rubyid_resources'>resources</span> <span class='symbol'>:speakers</span>
          <span class='id identifier rubyid_resources'>resources</span> <span class='symbol'>:accessories</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_resources'>resources</span> <span class='symbol'>:papers</span>
      <span class='id identifier rubyid_resources'>resources</span> <span class='symbol'>:pencils</span>
    <span class='kw'>end</span>

  <span class='kw'>end</span>

  <span class='id identifier rubyid_root'>root</span> <span class='symbol'>:to</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>home#index</span><span class='tstring_end'>'</span></span>                <span class='comment'># included in the default sitemap: /sitemap.xml
</span>  <span class='id identifier rubyid_resources'>resources</span> <span class='symbol'>:faqs</span>

<span class='kw'>end</span>
</code></pre>

<ul>
<li>Products sitemap includes paper and pencils.

<ul>
<li>Products/video includes dvd_players and accessories.</li>
<li>Products/video/bluray includes blu_ray_players.  Notice that the sitemap block includes the name: bluray.  If we would have excluded the name,
the routes within the block would have simply been added to /products/video/sitemap.xml and /products/video/bluray.xml would never be defined.</li>
<li>Products/audio includes head_phones, speakers, and accessories.</li>
</ul></li>
<li>The default sitemap includes the root url and FAQs.</li>
</ul>

<h3>Nested Resources</h3>

<h3>Route Filters</h3>

<h2>Logging</h2>

<p>Duck Map keeps a detailed log during the generation of a sitemap.  Use this log to determine why a route is or is not being included in a siteamp.  The default
log level is :info.  Switch to :debug to see every step in the process.  The location of the log file is in the standard Rails log directory and the file is
named: duck_map.log.</p>

<h2>Generators</h2>

<h3>duckmap:sitemaps</h3>

<p>The following rails generator will display all of the sitemap routes defined in config/routes.rb</p>

<pre class="code ruby"><code>rails g duckmap:sitemaps

Sitemap routes
route name                               controller_name#action_name
                                         path
---------------------------------------------------------------------------------------------------------------
sitemap_sitemap                          sitemap#sitemap
                                        /sitemap.:format
</code></pre>

<h3>duckmap:static</h3>

<h3>duckmap:sync</h3>

<p>Sychronizing with .git and local files on disk.
You have the power to include any route within a sitemap.  There is no requirement to have a model associated with any given route.  In fact, you may have a route
with several actions that contain some type of content where it makes sense that the last time the actual view file for an action represents the actual
last modified date for that action.  There are two ways to synchronize last modified dates for an application.</p>

<pre class="code ruby"><code><span class='comment'># via rails generator
</span><span class='id identifier rubyid_rails'>rails</span> <span class='id identifier rubyid_g'>g</span> <span class='label'>duck_map:</span><span class='id identifier rubyid_sync'>sync</span>

<span class='comment'># via rails task
</span><span class='id identifier rubyid_rake'>rake</span> <span class='label'>duck_map:</span><span class='id identifier rubyid_sync'>sync</span>
</code></pre>

<p>The acutal timestamp values are stored in a locale at: config/locales/sitemap.yml  Below is sample content.</p>

<pre class="code ruby"><code>--- 
:sitemap: 
  home: 
    index: 10/24/2011 02:03:51
</code></pre>

<p>When a Rails app needs a lastmod for a controller it will look to this file as the source for static values.  Running the generator or rake task will populate this
file for you, however, you have the option of manually editing this file.  The synchronization process uses the values in this file when deciding which timestamp
to use as the last modified date for an actions view file.  The decision is very simple.  The synchronization process will grab the timestamp from the actual view file
for the action on local disk, grab the timestamp of the same view file from a .git repository, and grab the timestamp of the view file from config/locales/sitemap.yml,
then, it will compare all three values.  The value that is the latest date/time wins the fight and that value is stored for the action inside config/locales/sitemap.yml</p>

<p>It is up to you to decide when to run the synchronization process.  If you are using a .git repository, then, you would have to commit all of you files, run the
synchronization process, then, commit again.  It may be an option to run the synchronization process during some type of central deployment procedure or even run
it on the production server.</p>

<h2>Demo applications</h2>

<p>You can find articles and demo apps at: <a href="http://jeffduckett.com/blogs.html">http://jeffduckett.com/blogs.html</a></p>

<h2>Copyright</h2>

<p>Copyright (c) 2011 Jeff Duckett. See license.txt for details.</p>
</div></div>

    <div id="footer">
  Generated on Mon Feb 18 14:32:22 2013 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.3 (ruby-1.9.3).
</div>

  </body>
</html>